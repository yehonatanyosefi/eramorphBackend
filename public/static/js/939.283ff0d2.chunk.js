"use strict";(self.webpackChunkeramorph=self.webpackChunkeramorph||[]).push([[939],{939:function(e,t,n){n.r(t),n.d(t,{default:function(){return p}});var s=n(3433),o=n(9439),r=n(2791),a=n(7721),c=n.n(a),i=n(184),u="",l=[{pose:"Mountain",imgSrc:"".concat(u,"/imgs/mountain.svg")},{pose:"Tree",imgSrc:"".concat(u,"/imgs/tree.svg")},{pose:"Downward Dog",imgSrc:"".concat(u,"/imgs/dog.svg")},{pose:"Warrior I",imgSrc:"".concat(u,"/imgs/warrior1.svg")},{pose:"Warrior II",imgSrc:"".concat(u,"/imgs/warrior2.svg")},{pose:"Chair",imgSrc:"".concat(u,"/imgs/chair.svg")}],d=1e4,m=function(){(0,r.useEffect)((function(){var e=document.createElement("script");return e.src="".concat(u,"/lib/ml5.min.js"),e.async=!0,e.onload=function(){a(!0)},document.body.appendChild(e),function(){document.body.removeChild(e)}}),[]);var e=(0,r.useState)(!1),t=(0,o.Z)(e,2),n=t[0],a=t[1],m=(0,r.useState)(null),p=(0,o.Z)(m,2),g=p[0],h=p[1],f=(0,r.useState)(null),v=(0,o.Z)(f,2),S=v[0],y=v[1],j=(0,r.useState)(null),x=(0,o.Z)(j,2),w=x[0],Z=x[1],k=(0,r.useState)([]),N=(0,o.Z)(k,2),b=N[0],C=N[1],E=(0,r.useState)(d),I=(0,o.Z)(E,2),L=I[0],M=I[1],T=(0,r.useState)(""),D=(0,o.Z)(T,2),G=D[0],P=D[1],R=(0,r.useState)(!1),W=(0,o.Z)(R,2),Y=W[0],O=W[1],V=(0,r.useState)(!1),_=(0,o.Z)(V,2),q=_[0],z=_[1],A=(0,r.useState)(""),B=(0,o.Z)(A,2),F=B[0],H=B[1],J=(0,r.useState)("loading"),K=(0,o.Z)(J,2),Q=K[0],U=K[1],X=(0,r.useState)(null),$=(0,o.Z)(X,2),ee=$[0],te=$[1],ne=(0,r.useRef)([]),se=(0,r.useRef)(!1),oe=(0,r.useRef)(null),re=(0,r.useMemo)((function(){return!q||!Y||"Ended"===Q}),[q,Y,Q]),ae=(0,r.useMemo)((function(){return q&&Y?"teaching"===Q?"Start Teaching":"Start Game":"Loading..."}),[q,Y,Q]);(0,r.useEffect)((function(){U("teaching")}),[]);var ce=function(){O(!0)},ie=function(){z(!0)},ue=function(){try{if(g&&S.length){for(var e=[],t=0;t<g.keypoints.length;t++){var n=g.keypoints[t].position.x,o=g.keypoints[t].position.y;e.push(n),e.push(o)}oe.current.classify(e,me).catch((function(e){console.error("Classification error:",e)}))}else H("Not found"),ne.current=[].concat((0,s.Z)(ne.current),[null]);le()}catch(r){console.log("Caught Error",r)}},le=function(){M((function(e){var t=e-100;if(t<=0)return clearTimeout(ee),se.current?de():(C(ne.current),ne.current=[],P("Let's start, you need to repeat the last video")),d;var n=setTimeout(ue,100);return te(n),t}))},de=function(){var e=b.reduce((function(e,t,n){return t===ne.current[n]?e+1:e}),0),t=Math.round(e/100*100);P("Game ended, your success rate is: ".concat(t,"%")),se.current=!1,U("Ended")},me=function(e,t){if(!e&&t)if(t[0].confidence<.7)H("Pose not found"),ne.current=[].concat((0,s.Z)(ne.current),[null]);else{var n=parseInt(t[0].label),o=l[n];H(o.pose),ne.current=[].concat((0,s.Z)(ne.current),[o])}else ne.current=[].concat((0,s.Z)(ne.current),[null])};return(0,i.jsxs)("div",{className:"pose-display",children:[(0,i.jsx)("div",{className:"pose-list",children:l.map((function(e){return(0,i.jsxs)("div",{className:"pose-item",children:[(0,i.jsx)("img",{src:e.imgSrc,className:"pose-img",alt:"".concat(e.pose," Pose")}),(0,i.jsx)("div",{className:"pose-name",children:e.pose})]},e.pose)}))}),(se.current||"testing"===Q)&&(0,i.jsxs)("p",{className:"current-pose",children:["Pose: ",F]}),n&&(0,i.jsx)(c(),{setup:function(e,t){e.createCanvas(640,480).parent(t);var n=e.createCapture(e.VIDEO);n.hide(),Z(n),window.ml5.poseNet(n,ie).on("pose",(function(e){e.length>0&&(h(e[0].pose),y(e[0].skeleton))}));oe.current=window.ml5.neuralNetwork({inputs:34,outputs:6,task:"classification",debug:!0});var s={model:"".concat(u,"/models/model2.json"),metadata:"".concat(u,"/models/model_meta2.json"),weights:"".concat(u,"/models/model.weights2.bin")};oe.current.load(s,ce)},draw:function(e){if(e.background(0),e.push(),e.translate(w.width,0),e.scale(-1,1),e.image(w,0,0,w.width,w.height),g)for(var t=0;t<S.length;t++){var n=S[t][0],s=S[t][1];e.strokeWeight(2),e.stroke(244,194,194),e.line(n.position.x,n.position.y,s.position.x,s.position.y)}e.pop()},className:"pose-canvas"}),(0,i.jsx)("p",{className:"message",children:G}),(se.current||"testing"===Q)&&(0,i.jsx)("p",{className:"time",children:L}),(0,i.jsx)("button",{onClick:function(){if(!q||!Y)return P("Still Loading...");console.log(Q),"teaching"===Q?(P("Let's start, you have 10 seconds to do any pose you like"),U("testing"),ue()):"testing"===Q&&(se.current=!0,P("Game started! You have 10 seconds to repeat the poses"),U("Started"),ue())},disabled:re,className:"start-button ".concat(re?"disabled":""),children:ae})]})};function p(){return(0,i.jsxs)("div",{className:"yoga-app",children:[(0,i.jsx)("header",{className:"header",children:(0,i.jsx)("h1",{children:"Yoga"})}),(0,i.jsx)(m,{})]})}}}]);
//# sourceMappingURL=939.283ff0d2.chunk.js.map